<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pasapalabra Pro: Generaci칩n IA</title>
    <style>
        /* Estilos heredados del dise침o 'Virus' */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@600&family=Roboto:wght@400;700&display=swap');
        :root { --bg: #070f1a; --orange: #ff7b00; --blue: #3498db; }
        body { background: var(--bg); color: white; font-family: 'Roboto', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        
        .panel { width: 450px; padding: 30px; border: 2px solid var(--orange); border-radius: 40px; background: rgba(15, 29, 46, 0.8); text-align: center; box-shadow: 0 0 20px rgba(255, 123, 0, 0.2); }
        .btn { width: 100%; padding: 15px; margin: 10px 0; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; color: white; font-size: 1rem; }
        .btn-orange { background: linear-gradient(180deg, #ff9500 0%, #d35400 100%); }
        .btn-blue { background: var(--blue); }
        
        .rosco-container { position: relative; width: 420px; height: 420px; margin-bottom: 20px; }
        .letra { position: absolute; width: 35px; height: 35px; background: #0044ff; border: 2px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.8rem; }
        .activa { background: var(--orange) !important; transform: scale(1.2); box-shadow: 0 0 15px var(--orange); }
        .correcta { background: #2ecc71 !important; }
        .fallada { background: #e74c3c !important; }
        
        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        .hidden { display: none !important; }
        #staff-tag { position: fixed; top: 10px; right: 10px; color: var(--orange); font-weight: bold; }
    </style>
</head>
<body>

    <div id="staff-tag" class="hidden">游녬 SUPERADMIN: PABLO</div>

    <div id="loading-overlay">
        <h2 style="color: var(--orange)">GENERANDO PARTIDA DESDE INTERNET...</h2>
        <p>El virus est치 hackeando preguntas nuevas...</p>
    </div>

    <div id="menu-screen" class="hidden">
        <h1 style="font-family: 'Fredoka'; font-size: 3.5rem; margin-bottom: 10px;">JUEGO <span style="color:var(--orange)">VIRUS</span></h1>
        <div class="panel">
            <button class="btn" style="background:transparent; border:1px solid #2c3e50" onclick="loginStaff()">SUPERADMIN</button>
            <button class="btn btn-orange" onclick="startGame()">JUGAR AHORA</button>
            <p style="font-size: 0.8rem; color: #666;">Cada vez que recargas, el rosco es diferente.</p>
        </div>
    </div>

    <div id="game-screen" class="hidden">
        <div class="rosco-container" id="rosco"></div>
        <div class="panel">
            <h2 id="current-letter" style="color:var(--orange); margin:0">CON LA A</h2>
            <p id="question-text" style="min-height: 50px;">Cargando...</p>
            <input type="text" id="ans-input" class="btn" style="background:#111b2d; border:1px solid #2c3e50; text-align:center" placeholder="Respuesta...">
            <button class="btn btn-orange" onclick="check()">ENVIAR</button>
            <button class="btn btn-blue" onclick="skip()">PASAR PALABRA</button>
        </div>
    </div>

    <script>
        // CONFIGURACI칍N - API KEY ACTUALIZADA
        const API_KEY = "AIzaSyDSpi8bIHstIvtAKn5H1IajWLZMRjqr-Yg"; 
        
        let roscoData = []; 
        let currentIndex = 0;
        let score = 0;

        async function fetchQuestionsFromAI() {
            const prompt = "Genera un JSON de 27 objetos para Pasapalabra (letras A-Z incluyendo 칌). Formato: {\"letra\":\"...\", \"pregunta\":\"...\", \"respuesta\":\"...\"}. Aseg칰rate de que las definiciones sean profesionales y en espa침ol.";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                const json = await response.json();
                let text = json.candidates[0].content.parts[0].text;
                text = text.replace(/```json/g, "").replace(/```/g, "").trim();
                roscoData = JSON.parse(text);
                
                document.getElementById('loading-overlay').classList.add('hidden');
                document.getElementById('menu-screen').classList.remove('hidden');
            } catch (error) {
                console.error("Error conectando a internet:", error);
                alert("Error al conectar con la IA. Revisa tu API KEY.");
            }
        }

        function loginStaff() {
            if(prompt("PASSWORD:") === "Pablo23sek") {
                document.getElementById('staff-tag').classList.remove('hidden');
                alert("Modo Superadmin activado");
            }
        }

        function startGame() {
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            renderRosco();
            showQuestion();
        }

        function renderRosco() {
            const container = document.getElementById('rosco');
            const radius = 180;
            roscoData.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = "letra";
                div.id = "L-" + i;
                div.innerText = item.letra;
                const angle = (i * (360 / 27) - 90) * (Math.PI / 180);
                div.style.left = (Math.cos(angle) * radius + 210 - 17) + "px";
                div.style.top = (Math.sin(angle) * radius + 210 - 17) + "px";
                container.appendChild(div);
            });
        }

        function showQuestion() {
            if(currentIndex >= roscoData.length) {
                alert("FIN! Aciertos: " + score);
                location.reload();
                return;
            }
            const data = roscoData[currentIndex];
            document.getElementById('current-letter').innerText = "CON LA " + data.letra;
            document.getElementById('question-text').innerText = data.pregunta;
            document.querySelectorAll('.letra').forEach(l => l.classList.remove('activa'));
            document.getElementById("L-"+currentIndex).classList.add('activa');
        }

        function check() {
            const user = document.getElementById('ans-input').value.toLowerCase().trim();
            const correct = roscoData[currentIndex].respuesta.toLowerCase().trim();
            const el = document.getElementById("L-"+currentIndex);

            if(user === correct) {
                el.classList.add('correcta');
                score++;
            } else {
                el.classList.add('fallada');
            }
            currentIndex++;
            document.getElementById('ans-input').value = "";
            showQuestion();
        }

        function skip() {
            currentIndex++;
            showQuestion();
        }

        fetchQuestionsFromAI();
    </script>
</body>
</html>
